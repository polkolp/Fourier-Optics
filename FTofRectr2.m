%FTofRect.m% Shows Fourier components of rectangle function% J.R. Fienup 8/25/02, modified 9/8/08clear allsecondwayonly=0;% Showing sum of cosines, with the cosines computed two different ways% first way of computing cosines is by Fourier method% the second way is by explicitly computing cosinesif secondwayonly~=1,	n=128;ndc=fix(n/2)+1;kmax=ndc-1;u=[1:n]-ndc;x=u; w=64; xw=w; xind=[ndc-xw+1:ndc+xw-1];fmin=-.7;fmax=1.3;nFont=12;pauselen=[5,5,5,1,1,1,1,0.5*ones(1,n)];f=zeros(n,1);f(1:w)=ones(w,1);wdc=fix(w/2)+1;f=shiftwrap(f,-wdc,0);fshift=fftshift(f);figure(1);subplot(3,1,1)plot(x(xind),fshift(xind),'LineWidth',2);v=axis;v(3:4)=[fmin,fmax];axis(v)title('rect function','FontSize',nFont)F=fftn(f); Fshift=fftshift(F);figure(2);subplot(2,1,1);plot(u,real(Fshift/n))Fw=20; Find=(ndc-Fw:ndc+Fw);subplot(2,1,2);plot(u(Find),real(Fshift(Find)/n),'b',u(Find),real(Fshift(Find)/n),'o',u(Find),zeros(length(Find)),'k')title('Fourier coefficients','FontSize',nFont)figure(1);sumterms=zeros(n,1);term0=zeros(n,1);term0(1)=F(1);term0=real(ifftn(term0));sumterms=sumterms+term0;subplot(3,1,2); plot(x,zeros(length(x)),'k',x,fftshift(term0),'b');title('one Fourier component','FontSize',nFont)v=axis;v(3:4)=[fmin,fmax];axis(v)subplot(3,1,3); plot(x,zeros(length(x)),'k',x,fftshift(sumterms),'b');title('sum of Fourier components','FontSize',nFont) v=axis;v(3:4)=[fmin,fmax];axis(v)pausefor k=1:kmax,	term=zeros(n,1);	term(k+1)=F(k+1); term(n-k+1)=F(n-k+1);	term=real(ifftn(term));	sumterms=sumterms+term;	termsh=fftshift(term);	sumtermssh=fftshift(sumterms);	if k~=2*fix(k/2),		k		subplot(3,1,2); plot(x(xind),zeros(length(xind)),'k',x(xind),termsh(xind),'b');		title('one Fourier component','FontSize',nFont)	v=axis;v(3:4)=[fmin,fmax];axis(v)		subplot(3,1,3); plot(x(xind),zeros(length(xind)),'k',x(xind),sumtermssh(xind),'b');		title('sum of Fourier components','FontSize',nFont)		v=axis;v(3:4)=[fmin,fmax];axis(v)	end	if k<=6,		pause		else,		pause(pauselen(k))	end	endpauseend; % of if secondwayonly~=1%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%Alternative way: explicitly sum cosines%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%nterms = 100;nv=[1:99];coefv=sinc(nv/2);coefv=[0.5,coefv];n=1000;ndc=fix(n/2)+1;x=[1:n].'-ndc;x=x/n;w=63; xw=w; xind=[ndc-xw:ndc+xw];fmin=-.2;fmax=1.2;nFont=12;pauselen=[5,5,5,1,1,1,1,1*ones(1,n)];figure(3); clf;sumterms=zeros(n,1);% term0=zeros(n,1);% term0=coefv(1)*ones(n,1);% sumterms=sumterms+term0;plot(x,zeros(length(x)),'k',x,sumterms,'b');title('sum of Fourier components','FontSize',nFont) v=axis;v(3:4)=[fmin,fmax];axis(v)pausefor k=1:nterms,	term=coefv(k)*cos(2*pi*(k-1)*x);	sumterms=sumterms+term;		k-1		figure(3);plot(x,zeros(n,1),'k',x,sumterms,'b');		title('sum of Fourier components','FontSize',nFont)		v=axis;v(3:4)=[fmin,fmax];axis(v)	if k<=6,		pause		else if 2*fix((k-1)/2)~=(k-1); % i.e. if (k-1) is odd		pause(pauselen(k))		end	end	end	