% Examples of Fourier transforms% J.R. Fienup September, October 2002% Modified 4/4/07 making n = 500 and adding rotated squaren=500; % array size (reduce this if memory is a problem)ndc=fix(n/2)+1; % middle of array% small circleoutrad=8.5;aper=circleshade(n,outrad);figure(1); showp(aper,1,1)ft=fftshift(fftn(fftshift(aper)));figure(2); showp(ft,1,1)pauseshowp(sqrt(ft),2,1)figure(3);plot(abs(ft(ndc,:)))pause% circleoutrad=32.4;w=fix(2*outrad);aper=circleshade(n,outrad);figure(1); showp(aper,1,1)ft=fftshift(fftn(fftshift(aper)));figure(2); showp(ft,1,1)pauseshowp(sqrt(ft),2,1)figure(3);plot(abs(ft(ndc,:)))pause% annulusoutrad=32.4;inrad=24;aper=circleshade(n,outrad)-circleshade(n,inrad);figure(1); showp(aper,1,1)ft=fftshift(fftn(fftshift(aper)));figure(2); showp(ft,1,1)pauseshowp(sqrt(ft),2,1)figure(3);hold on; plot(abs(ft(ndc,:)),'r');hold off% squarepauseaper=zeros(n,n);w=fix(2*outrad);aper(1:w,1:w)=ones(w,w);wd2=fix(w/2);aper=shiftwrap(aper,ndc-wd2,ndc-wd2);figure(1); showp(aper,1,1)ft=fftshift(fftn(fftshift(aper)));figure(2); showp(ft,1,1)pauseshowp(sqrt(ft),2,1)figure(3);plot(abs(ft(ndc,:)),'r')% Added 2007: rotated squarepauseaper=imrotate(aper,45,'bilinear','crop');figure(1); showp(aper,1,1)ft=fftshift(fftn(fftshift(aper)));figure(2); showp(ft,1,1)pauseshowp(sqrt(ft),2,1)figure(3);plot(abs(ft(ndc,:)),'r')% pause% two wide slitsaper=zeros(n,n);% wd8=fix(w/8);% aper(1:wd8,1:w)=ones(wd8,w);% aper(w-wd8+1:w,1:w)=ones(wd8,w);% wd2=fix(w/2);% aper=shiftwrap(aper,ndc-wd2,ndc-wd2);% figure(1); showp(aper,1,1)% ft=fftshift(fftn(fftshift(aper)));% figure(2); showp(ft,1,1)% pause% showp(sqrt(ft),2,1)% figure(3);% plot(abs(ft(ndc,:)),'r')% % pause% two narrow rectangles%one small shifted squarepauseaper=zeros(n,n);wd8=fix(w/8);aper(1:wd8,1:wd8)=ones(wd8,wd8);wd2=fix(w/2);aper=shiftwrap(aper,ndc-fix(wd8/2),ndc-fix(wd8/2));figure(1); showp(aper,1,1)ft=fftshift(fftn(fftshift(aper)));figure(2); showp(ft,1,1)pauseshowp(sqrt(ft),2,1)figure(3);plot(abs(ft(ndc,:)),'r')%second small shifted squarepauseaper=zeros(n,n);wd8=fix(w/8);aper(w-wd8+1:w,1:wd8)=ones(wd8,wd8);wd2=fix(w/2);aper=shiftwrap(aper,ndc-fix(wd8/2),ndc-fix(wd8/2));figure(1); showp(aper,1,1)ft=fftshift(fftn(fftshift(aper)));figure(2); showp(ft,1,1)pauseshowp(sqrt(ft),2,1)figure(3);plot(abs(ft(ndc,:)),'r')%two small shifted squarespauseaper=zeros(n,n);wd8=fix(w/8);aper(1:wd8,1:wd8)=ones(wd8,wd8);aper(w-wd8+1:w,1:wd8)=ones(wd8,wd8);wd2=fix(w/2);aper=shiftwrap(aper,ndc-fix(wd8/2),ndc-fix(wd8/2));figure(1); showp(aper,1,1)ft=fftshift(fftn(fftshift(aper)));figure(2); showp(ft,1,1)pauseshowp(sqrt(ft),2,1)figure(3);plot(abs(ft(ndc,:)),'r')pause% two narrow slitsaper=zeros(n,n);wd8=fix(w/8);len=fix(n/2);aper(1:wd8,1:len)=ones(wd8,len);aper(w-wd8+1:w,1:len)=ones(wd8,len);wd2=fix(w/2); lend2=fix(len/2);aper=shiftwrap(aper,ndc-fix(wd8/2),ndc-lend2);figure(1); showp(aper,1,1)ft=fftshift(fftn(fftshift(aper)));figure(2); showp(ft,1,1)pauseshowp(sqrt(ft),2,1)figure(3);plot(abs(ft(ndc,:)),'r')pause%triangleaper=zeros(n,n);for k=1:w/2	aper(k,(w/2-(k-1)):w/2)=ones(1);endfor k=(w/2+1):w	aper(k,(k-w/2):w/2)=ones(1);end% for k=w/2+1:2,% 	aper(k,1:k)=ones(1);% endwd2=fix(w/2);aper=shiftwrap(aper,ndc-wd2,ndc-wd2);figure(1); showp(aper,1,1)ft=fftshift(fftn(fftshift(aper)));pausefigure(2); showp(ft,1,1)pauseshowp(sqrt(ft),2,1)figure(3);plot(abs(ft(ndc,:)),'r')pause;figure(2); showp(sqrt(ft),1,1)pause% Fourier example - parallelogramndc=fix(n/2)+1;w=20; h=40;aper=zeros(n,n);for k=1:w,	aper(k:k+h-1,k)=ones(h,1);endaper=flipud(aper);aper=shift(aper,-ndc-fix(h/2),ndc-fix(w/2));figure(1); showp(aper,1,1)ft=fftshift(fftn((aper)));pausefigure(2); showp(ft,1,1)showp(sqrt(ft),2,1)figure(3);plot(abs(ft(ndc,:)),'r')