% Fresnel examples% Compute Fresnel transform using 2 DFT's% J.R. Fienup October/November 2002n=512; ndc=fix(n/2)+1;u=zeros(n,n);nap=fix(n/2.);  % size of square apertureu(1:nap,1:nap)=ones(nap,nap);u=shiftwrap(u,fix(n/2)-fix(nap/2),fix(n/2)-fix(nap/2)); % center it in array% u=circleshade(n,n/4);uft=fftshift(fftn(fftshift(u)));x=[1:n]-ndc;[fy,fx]=meshgrid(x,x);fxr2=fx.^2 + fy.^2; % these are the p's and q's squaredfor nf=[5, 10, 100],  % Fresnel number: larger is better for this 2-DFT versionradcoeff=pi*nap^2/(4*nf*n^2);expqph=exp(-i*radcoeff*fxr2);uout=uft.*expqph;uout=fftshift(ifftn(fftshift(uout)));figure(1);plot(abs(uout(ndc,:))); title(['Fresnel diffraction, NF = ',num2str(nf)])figure(2);showp(uout,1,1)pauseendreturn