% Single-DFT Fresnel of a square aperture% J.R. Fienup, October 2002n=200; ndc=fix(n/2)+1;u=zeros(n,n);nap=fix(n/2);u(1:nap,1:nap)=ones(nap,nap);u=shiftwrap(u,fix(n/2)-fix(nap/2),fix(n/2)-fix(nap/2));x=[1:n]-ndc;[fy,fx]=meshgrid(x,x);fxr2=fx.^2 + fy.^2; % these are the p's and q's squaredfor nf=[20,5,1],  % Fresnel numbers. Smaller is better for single-DFT Fresnelradcoeff=pi*nf/(nap/2)^2;expqph=exp(i*radcoeff*fxr2);uout=fftshift(fftn(fftshift(u.*expqph)));% no phase terms out front -- just looking at magnitudesfigure(1);plot(abs(uout(ndc,:))); title(['Fresnel diffraction, NF = ',num2str(nf)])v=axis;v(2)=n;axis(v)figure(2);showp(uout,1,1)pause;endreturn